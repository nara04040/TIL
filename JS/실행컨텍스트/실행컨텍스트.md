# 실행 컨텍스트란? 

실행할 코드에 제공할 환경 정보들을 모아놓은 **객체**.

자바스크립트의 동적언아로서의 성격을 가장 잘 파악할 수 있는 개념이다.

자바스크립트는 어떤 실행 컨텍스트가 활성화 되는 시점에 선언된 변수를 위로 끌어올려 외부 환경을 구성하고 this값을 설정하는 동작을 수행한다.

이로인해서 특이한 현상들이 발생한다.

실행 컨텍스트를 알기위해선 **스택(stack)** **큐(queue)** 에 대하여 알아야한다.

## 스택

**스택**은 출입구가 하나인 깊은 우물 같은 데이터 구조라고 생각하자.

비어있는 스택에 순서대로 a,b,c,d 를 저장했다면 꺼낼 때는 반대로 d,c,b,a 순서로 꺼낼 수 밖에 없다.

**큐**는 양쪽이 열려있는 파이프를 생각하자.

양쪽 모두 입력과 출력이 가능한 큐도 있을수 있지만, 

보통 한쪽은 입력, 한쪽은 출력만 담당하는 구조다.

즉 동일한 환경에 있는 코드들을 실행할때 필요한 환경 정보를 모아서 컨텍스트를 구성하고,

이를 콜 스택에 쌓아올렸다가 가장 위에 쌓여있는 컨텍스트와 관련있는 코드를 실행하는 식으로 전체 코드의 환경과 순서를 보장한다.

우리가 실행컨텍스트를 구성하는 방법은 **함수를 실행**하는 것 뿐이다. (eval를 제외하면)

```javascript
////////// (1)
var a = 1;
function outer(){
    function inner() {
        console.log(a); // undefined
        var a = 3;
    }

    inner();  //////////////(2)
    console.log(a) // 1
}
outer(); ///////////////(3)
console.log(a) // 1
```

자바스크립트 코드를 실행하는 순간 , 전역 컨텍스트가 콜스택에 담긴다.

콜 스택에는 전역 컨텍스트와 관련된 코드들을 순차로 진행하다 (3)의 위치에서 outer함수를 호출하면 자바스크립트 엔진은 outer에 대한 환경 정보를 수집하여 outer 실행 컨텍스트를 생성 후 콜 스택에 담는다.

지금 콜스택을 바라보자면 맨 위가 outer 실행 컨텍스트가 놓인 상태이다. 

전역 컨텍스트와 관련된 코드실행을 중단하고 outer실행 컨텍스트와 관련된 코드를 순차로 실행시킨다.

이후 (2)에서 inner함수 실행컨텍스트가 위에 담기면 전역 컨텍스트(최하단),outer(중앙), inner(최상단)으로 스택이 쌓여있다.
고로 outer컨텍스트 코드의 실행을 중단하고 inner함수 내부의 코드를 순서대로 진행시킨다.

inner함수 내부에서 a변수에 3을 할당하면 함수실행이 종료되고 inner실행 컨텍스트가 콜 스택에서 제거된다.

다시 outer컨텍스트가 실행되고 a변수값을 출력하면 outer함수의 실행이 종료, 콜스택에서 제거되고 콜스택에는 전역 컨텍스트만 남는다.

이후 (3)의 다음줄부터 코드실행되고 a변수값을 출력하고 난다면 전역컨텍스트도 제거되므로 콜스택에 아무것도 남지않아 종료된다.

어떤 실행 컨텍스트가 활성화될 때 자바스크립트 엔진은 컨텍스트의 코드를 실행하는 데에 필요한 환경 정보들을 수집하여 실행 컨텍스트 객체에 저장한다.

자바스크립트 엔진이 활용할 목적으로 생성할 뿐 개발자는 코드를 통해서 이를 확인할 수 없다.

